<html>
<p>Convert MS Access Form to Angular JS template</p>
<p>Enter MS Access Form text here:</p>
<div><textarea id="ms-access-form"></textarea></div>
<button type="button" onclick="convert();">Convert to Angular JS template</button>
<div><textarea id="angular-js-template"></textarea></div>
<script>
function convert(){
  var msAccessForm = document.getElementById('ms-access-form').value;
  var template = convertForm(msAccessForm);
  document.getElementById('angular-js-template').value = template;
}

function convertForm(msAccessForm){
  var re = /(Begin Form(.|\n)*End)\nCodeBehindForm/i;
  var found = msAccessForm.match(re);
  return convertElement(found[1]);
}

function convertElement(msAcessFormElement){
  var re = /Begin\s*(.*)\n((.|\n)*)\nEnd/i
  var found = msAcessFormElement.match(re);
  if(found !== null && found.length > 1){
    if(found[1] == "Form"){
      return '<div class="ms-access-form">' + convertElement(found[2]) + '</div>';
    }
  } else {
    return msAcessFormElement;//nothing to convert  
  }
}
</script>
</html>
