<html>
<p>Convert MS Access Form to Angular JS template</p>
<p>Enter MS Access Form text here:</p>
<div><textarea id="ms-access-form" cols=100 rows=15></textarea></div>
<button type="button" onclick="convert();">Convert to Angular JS template</button>
<div><textarea id="angular-js-template" cols=100 rows=15></textarea></div>
<div>Result:
<span id="result"></span>
</div>
<script>
function convert(){
  var msAccessForm = document.getElementById('ms-access-form').value;
  var template = convertForm(msAccessForm);
  document.getElementById('angular-js-template').value = template;
  document.getElementById('result').innerHTML = template;
}

function convertForm(msAccessForm){
  var re = /(Begin Form(.|\n)*End)\nCodeBehindForm/i;
  var found = msAccessForm.match(re);
  return convertElement(found[1]);
}

function convertElement(msAcessFormElement){
  var re = /Begin\s*(.*)\n((.|\n)*)\nEnd/i
  var found = msAcessFormElement.match(re);
  if(found !== null && found.length > 1){
    var elementName = found[1];
    var elementData = found[2];
    if(elementName == "Form"){
      return 
      '<b>' + getCaption(elementData) + '</b>' +
      '<div class="ms-access-form" ' +
      'style="width:' + getWidth(elementData) + 'px">' +
      convertElement(elementData) +
      '</div>';
    }
  } else {
    return msAcessFormElement;//nothing to convert  
  }
}

var twipX = 36/576;//twip to 36 pixels in 1 cm
var twipY = 36/576;//twip to 36 pixels in 1 cm

function getWidth(elementData){
  var re = /Width\s=(\d*)/i;
  var found = elementData.match(re);
  if(found !== null && found.length > 1){
    return found[1]*twipX;
  }
  return 0;
}

function getCaption(elementData){
  var re = /Caption\s=\s*\"(.*)\"/i;
    var found = elementData.match(re);
    if(found !== null && found.length > 1){
      return found[1];
    }
    return '';  
}

</script>
</html>
